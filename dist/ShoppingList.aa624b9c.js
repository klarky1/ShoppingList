const e={form:document.getElementById("product-form"),textInput:document.getElementById("product-text-input"),alertPopup:document.getElementById("product-form").querySelector(".alert"),list:document.getElementById("product-ordered-list")},t={formContainer:document.getElementById("modal-1"),form:document.getElementById("modal-form"),textInput:document.getElementById("modal-text-input"),cancelBtn:document.getElementById("modal-cancel-button"),alertPopup:document.getElementById("modal-form").querySelector(".alert"),confirmContainer:document.getElementById("modal-2"),yesBtn:document.getElementById("modal-yes-button"),noBtn:document.getElementById("modal-no-button")},l={checkTooltip:document.getElementById("check-button").querySelector(".tooltip"),checkbox:document.getElementById("toggle-all-checkbox"),checkBtn:document.getElementById("check-button"),actionBtn:document.getElementById("action-button"),actionList:document.getElementById("action-unordered-list"),sortBtn:document.getElementById("sort-button"),sortInfoPopup:document.getElementById("sort-button").querySelector(".sort-type-info"),formBtn:document.getElementById("form-button"),showBtn:document.getElementById("show-button"),selectBtn:document.getElementById("select-button"),selectList:document.getElementById("select-unordered-list")},s={deleteSelectedBtn:document.getElementById("delete-selected-button"),resetColorsBtn:document.getElementById("reset-colors-button"),saveToDiskBtn:document.getElementById("save-to-disk-button"),deleteFromDiskBtn:document.getElementById("delete-from-disk-button")},n={},d={};let c=null;const i=[],r=[];let o=2;const a=()=>e.list.classList.contains("formed-list"),u=(e,t,l=1800,s=200)=>{e.style.visibility="visible",e.style.opacity=1,clearTimeout(r[t]),r[t]=setTimeout(()=>{e.style.opacity=0,setTimeout(()=>{e.style.visibility="hidden"},s)},l)},m=()=>{0!==e.list.children.length&&Array.from(e.list.children).every(e=>e.querySelector("input").checked)?(l.checkbox.checked=!0,l.checkTooltip.innerHTML="Remove<br>all"):(l.checkbox.checked=!1,l.checkTooltip.innerHTML="Select<br>all"),e.list.querySelector("li:has(input:checked)")?(l.formBtn.classList.remove("disabled"),s.deleteSelectedBtn.firstElementChild.classList.remove("disabled")):(l.formBtn.classList.add("disabled"),s.deleteSelectedBtn.firstElementChild.classList.add("disabled"))},p=()=>{e.list.querySelector("li.selected-product")?s.resetColorsBtn.firstElementChild.classList.remove("disabled"):s.resetColorsBtn.firstElementChild.classList.add("disabled")},h=()=>{0!==Object.keys(n).length||0!==i.length?s.saveToDiskBtn.firstElementChild.classList.remove("disabled"):s.saveToDiskBtn.firstElementChild.classList.add("disabled")},L=({productName:e,defaultIndex:t,currentIndex:l,selected:n,listName:i=c})=>{let r=document.createElement("li");r.dataset.productName=e,r.dataset.defaultIndex=t??Object.keys(d[i]).length,r.dataset.currentIndex=l??r.dataset.defaultIndex,r.innerHTML=`
    <span>${e}</span>
    <button>\u{2716}</button>
  `,r.addEventListener("click",E),r.querySelector("button").addEventListener("click",k),d[i][e]=r,n&&r.classList.add("selected-product"),s.saveToDiskBtn.firstElementChild.classList.remove("disabled")},v=({productName:e,defaultIndex:t,currentIndex:l,checked:d=!0})=>{let c=document.createElement("li");c.dataset.productName=e,c.dataset.defaultIndex=t??Object.keys(n).length,c.dataset.currentIndex=l??c.dataset.defaultIndex,c.innerHTML=`
    <div>
      <input class="visually-hidden" type="checkbox" ${d?"checked":""} />
      <span class="custom-checkbox"></span>
    </div>
    <span>${e}</span>
    <button>\u{2716}</button>
  `,c.addEventListener("click",f),c.querySelector("input").addEventListener("change",m),c.querySelector("button").addEventListener("click",k),n[e]=c,s.saveToDiskBtn.firstElementChild.classList.remove("disabled")},b=(t,s=c)=>{e.list.append(d[s][t]),e.list.children.length>1&&l.sortBtn.classList.remove("disabled")},f=e=>{getSelection().toString().length>0||e.currentTarget.querySelector("input").click()},E=e=>{e.currentTarget.classList.toggle("selected-product"),p()},k=t=>{let s=t.target.closest("li");s.remove(),a()?(B(s),p()):(y(s),m(),0===e.list.children.length&&l.checkBtn.classList.add("disabled")),h(),e.list.children.length<2&&l.sortBtn.classList.add("disabled")},B=(e,t=c)=>{e.removeEventListener("click",E),e.querySelector("button").removeEventListener("click",k),delete d[t][e.dataset.productName]},y=e=>{e.removeEventListener("click",f),e.querySelector("input").removeEventListener("change",m),e.querySelector("button").removeEventListener("click",k),delete n[e.dataset.productName]},g=()=>{l.actionList.hidden=!l.actionList.hidden,l.actionList.hidden&&document.removeEventListener("click",g)},I=()=>{e.list.replaceChildren(...Object.values(n).sort((e,t)=>e.dataset.currentIndex-t.dataset.currentIndex)),e.list.classList.remove("formed-list"),l.showBtn.classList.add("disabled"),s.resetColorsBtn.firstElementChild.classList.add("disabled"),m(),c=null,0!==e.list.children.length&&l.checkBtn.classList.remove("disabled"),e.list.children.length>1?l.sortBtn.classList.remove("disabled"):l.sortBtn.classList.add("disabled"),i.forEach(e=>{e.classList.remove("selected-list")})},x=()=>{t.textInput.value="",t.formContainer.hidden=!0,document.removeEventListener("click",x)},C=(e=c)=>{let t=document.createElement("li");t.dataset.listName=e,t.innerHTML=`
    <span>${e}</span>
    <button>\u{2716}</button>
  `,t.addEventListener("click",N),t.querySelector("button").addEventListener("click",q),i.push(t),l.selectBtn.classList.remove("disabled"),i.forEach(e=>{e.classList.remove("selected-list")}),t.classList.add("selected-list")},S=(t=c)=>{e.list.replaceChildren(...Object.values(d[t]).sort((e,t)=>e.dataset.currentIndex-t.dataset.currentIndex)),e.list.classList.add("formed-list"),l.checkBtn.classList.add("disabled"),l.showBtn.classList.remove("disabled"),l.formBtn.classList.add("disabled"),s.deleteSelectedBtn.firstElementChild.classList.add("disabled"),p(),e.list.children.length>1?l.sortBtn.classList.remove("disabled"):l.sortBtn.classList.add("disabled")},T=()=>{l.selectList.hidden=!l.selectList.hidden,l.selectList.hidden&&document.removeEventListener("click",T)},N=e=>{let t=e.currentTarget;c=t.dataset.listName,S(),i.forEach(e=>{e.classList.remove("selected-list")}),t.classList.add("selected-list")},q=e=>{let t=e.target.closest("li");t.remove(),t.dataset.listName===c&&I(),t.removeEventListener("click",N),e.target.removeEventListener("click",q),i.splice(i.indexOf(t),1),O(t.dataset.listName),i.length?e.stopPropagation():l.selectBtn.classList.add("disabled"),h()},O=e=>{Object.values(d[e]).forEach(t=>{B(t,e)}),delete d[e]};window.addEventListener("load",()=>{if(!localStorage.getItem("shopping-list-data"))return;let e=JSON.parse(localStorage.getItem("shopping-list-data"));e.productCollection.forEach(e=>{v(e)}),Object.entries(e.listCollection).forEach(([e,t])=>{d[e]={},C(e),t.forEach(e=>{L(e)})}),c=e.currentListName,c?S():I(),0!==Object.values(n).length&&Object.values(n).every(e=>e.querySelector("input").checked)?(l.checkbox.checked=!0,l.checkTooltip.innerHTML="Remove<br>all"):(l.checkbox.checked=!1,l.checkTooltip.innerHTML="Select<br>all"),s.deleteFromDiskBtn.firstElementChild.classList.remove("disabled")}),e.form.addEventListener("reset",()=>e.textInput.focus()),e.form.addEventListener("submit",t=>{t.preventDefault();let s=e.textInput.value.trim()[0].toUpperCase()+e.textInput.value.trim().toLowerCase().slice(1);if(a()){if(Object.hasOwn(d[c],s))return void u(e.alertPopup,0);L({productName:s}),b(s)}else{if(Object.hasOwn(n,s))return void u(e.alertPopup,0);v({productName:s}),e.list.append(n[s]),l.checkBtn.classList.remove("disabled"),m(),e.list.children.length>1&&l.sortBtn.classList.remove("disabled")}e.textInput.value=""}),l.checkBtn.addEventListener("click",e=>{l.checkbox.click()}),l.checkbox.addEventListener("change",t=>{l.checkbox.checked?(e.list.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!0),l.checkTooltip.innerHTML="Remove<br>all",l.formBtn.classList.remove("disabled"),s.deleteSelectedBtn.firstElementChild.classList.remove("disabled")):(e.list.querySelectorAll('input[type="checkbox"]').forEach(e=>e.checked=!1),l.checkTooltip.innerHTML="Select<br>all",l.formBtn.classList.add("disabled"),s.deleteSelectedBtn.firstElementChild.classList.add("disabled"))}),l.actionBtn.addEventListener("click",e=>{e.stopPropagation(),l.actionList.hidden&&document.addEventListener("click",g),g()}),s.deleteSelectedBtn.addEventListener("click",t=>{if(s.deleteSelectedBtn.firstElementChild.classList.contains("disabled"))return void t.stopPropagation();e.list.querySelectorAll("li:has(input:checked)").forEach(e=>{k({target:e})}),h()}),s.resetColorsBtn.addEventListener("click",t=>{if(s.resetColorsBtn.firstElementChild.classList.contains("disabled"))return void t.stopPropagation();Array.from(e.list.children).forEach(e=>{e.classList.remove("selected-product")}),p()}),s.saveToDiskBtn.addEventListener("click",e=>{if(s.saveToDiskBtn.firstElementChild.classList.contains("disabled"))return void e.stopPropagation();let t={productCollection:[],listCollection:{}};Object.values(n).forEach(e=>{t.productCollection.push({productName:e.dataset.productName,defaultIndex:e.dataset.defaultIndex,currentIndex:e.dataset.currentIndex,checked:e.querySelector("input").checked})}),Object.entries(d).forEach(([e,l])=>{t.listCollection[e]=[],Object.values(l).forEach(l=>{t.listCollection[e].push({productName:l.dataset.productName,defaultIndex:l.dataset.defaultIndex,currentIndex:l.dataset.currentIndex,selected:l.classList.contains("selected-product"),listName:e})})}),t.currentListName=c,localStorage.setItem("shopping-list-data",JSON.stringify(t)),s.deleteFromDiskBtn.firstElementChild.classList.remove("disabled")}),s.deleteFromDiskBtn.addEventListener("click",e=>{if(s.deleteFromDiskBtn.firstElementChild.classList.contains("disabled"))return void e.stopPropagation();t.confirmContainer.hidden=!1}),t.yesBtn.addEventListener("click",()=>{localStorage.clear(),s.deleteFromDiskBtn.firstElementChild.classList.add("disabled"),t.confirmContainer.hidden=!0}),t.noBtn.addEventListener("click",()=>{t.confirmContainer.hidden=!0}),l.sortBtn.addEventListener("click",()=>{let t;switch(o++,a()&&e.list.querySelector("li.selected-product")?(2===o&&(o=3),o>5&&(o=0)):o>2&&(o=0),o){case 0:t=Array.from(e.list.children).sort((e,t)=>e.dataset.productName.localeCompare(t.dataset.productName)),l.sortInfoPopup.textContent="A-Z";break;case 1:t=Array.from(e.list.children).sort((e,t)=>t.dataset.productName.localeCompare(e.dataset.productName)),l.sortInfoPopup.textContent="Z-A";break;case 3:t=Array.of(...e.list.querySelectorAll("li.selected-product"),...e.list.querySelectorAll("li:not(.selected-product)")),l.sortInfoPopup.innerHTML="green<br>up";break;case 4:t=Array.of(...e.list.querySelectorAll("li:not(.selected-product)"),...e.list.querySelectorAll("li.selected-product")),l.sortInfoPopup.innerHTML="green<br>down";break;default:t=Array.from(e.list.children).sort((e,t)=>e.dataset.defaultIndex-t.dataset.defaultIndex),l.sortInfoPopup.textContent="default"}u(l.sortInfoPopup,2,1200,100),t.forEach((e,t)=>e.dataset.currentIndex=t),e.list.replaceChildren(...t)}),l.showBtn.addEventListener("click",I),l.formBtn.addEventListener("click",e=>{e.stopPropagation(),t.formContainer.hidden=!1,document.addEventListener("click",x)}),t.form.addEventListener("submit",l=>{l.preventDefault();let s=t.textInput.value.trim()[0].toUpperCase()+t.textInput.value.trim().toLowerCase().slice(1);if(Object.hasOwn(d,s))return void u(t.alertPopup,1);d[s]={},c=s,e.list.querySelectorAll("li:has(input:checked)").forEach(e=>{L({productName:e.dataset.productName})}),C(),S(),x()}),t.form.addEventListener("click",e=>e.stopPropagation()),t.cancelBtn.addEventListener("click",x),l.selectBtn.addEventListener("click",e=>{e.stopPropagation(),l.selectList.hidden&&(l.selectList.replaceChildren(...i),document.addEventListener("click",T)),T()});
//# sourceMappingURL=ShoppingList.aa624b9c.js.map
